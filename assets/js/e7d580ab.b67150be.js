"use strict";(self.webpackChunksraddhanand=self.webpackChunksraddhanand||[]).push([[3612],{3905:function(e,t,a){a.d(t,{Zo:function(){return c},kt:function(){return d}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(a),d=r,k=p["".concat(l,".").concat(d)]||p[d]||m[d]||o;return a?n.createElement(k,i(i({ref:t},c),{},{components:a})):n.createElement(k,i({ref:t},c))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<o;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},214:function(e,t,a){a.r(t),a.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return m}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),i=["components"],s={id:"aws-ssm",title:"AWS Systems Manager"},l=void 0,u={unversionedId:"aws/aws-ssm",id:"aws/aws-ssm",title:"AWS Systems Manager",description:"Managed instances",source:"@site/docs/aws/aws-ssm.md",sourceDirName:"aws",slug:"/aws/aws-ssm",permalink:"/docs/aws/aws-ssm",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/aws/aws-ssm.md",tags:[],version:"current",frontMatter:{id:"aws-ssm",title:"AWS Systems Manager"},sidebar:"aws",previous:{title:"Aurora Database",permalink:"/docs/aws/aws-aurora"},next:{title:"S3 Hacks",permalink:"/docs/aws/aws-s3"}},c={},m=[{value:"Managed instances",id:"managed-instances",level:2},{value:"Resource Groups",id:"resource-groups",level:2},{value:"Documents",id:"documents",level:2},{value:"Parameter Store",id:"parameter-store",level:3},{value:"Sample code snippet for SSM document along with parameters",id:"sample-code-snippet-for-ssm-document-along-with-parameters",level:4},{value:"Session manager",id:"session-manager",level:2},{value:"How it works",id:"how-it-works",level:4},{value:"Hybrid Activation:",id:"hybrid-activation",level:3},{value:"Run Command",id:"run-command",level:2},{value:"State manager",id:"state-manager",level:2},{value:"Association",id:"association",level:3},{value:"Patch Manager",id:"patch-manager",level:2},{value:"Inventory",id:"inventory",level:2},{value:"Distributor",id:"distributor",level:2},{value:"Automation",id:"automation",level:2},{value:"References:",id:"references",level:2}],p={toc:m};function d(e){var t=e.components,a=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"managed-instances"},"Managed instances"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A centralized, consolidated view of your infrastructure regardless of on premises servers or AWS instances. "),(0,o.kt)("li",{parentName:"ul"},"Helps to track inventory, operational management, patching the systems, "),(0,o.kt)("li",{parentName:"ul"},"Create and use runbook-like documents which can be used to run on a system to perform some actions on the managed instances."),(0,o.kt)("li",{parentName:"ul"},"SSM agent on the server communicates with AWS SSM API"),(0,o.kt)("li",{parentName:"ul"},"AWS instances' IAM role need appropriate SSM policy "),(0,o.kt)("li",{parentName:"ul"},"On premises instances need to be configured using ",(0,o.kt)("strong",{parentName:"li"},"hybrid activation")," and SSM agent.")),(0,o.kt)("h2",{id:"resource-groups"},"Resource Groups"),(0,o.kt)("p",null,"Collection of AWS resources in the regions that matches certain criteria "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Tag based "),(0,o.kt)("li",{parentName:"ul"},"Cloudformation stack based")),(0,o.kt)("h2",{id:"documents"},"Documents"),(0,o.kt)("p",null,"Defines the actions along with parameters that the SSM performs in the managed instances. Writen in YAML or JSON."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Can be ",(0,o.kt)("strong",{parentName:"li"},"versioned")," and used any version."),(0,o.kt)("li",{parentName:"ul"},"Can also be ",(0,o.kt)("strong",{parentName:"li"},"shared publicly"),", with the specific account "),(0,o.kt)("li",{parentName:"ul"},"Control users/resources using ",(0,o.kt)("strong",{parentName:"li"},"IAM policies"))),(0,o.kt)("h3",{id:"parameter-store"},"Parameter Store"),(0,o.kt)("p",null,"Provides secure, hierarchical storage for configuration data management and secret management"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Similar to veriables, we can define parameters for ",(0,o.kt)("strong",{parentName:"li"},"documents/scripts/commads"),"."),(0,o.kt)("li",{parentName:"ul"},"Can integrate with AWS services along with SSM.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"EC2"),(0,o.kt)("li",{parentName:"ul"},"ECS"),(0,o.kt)("li",{parentName:"ul"},"Lambda"),(0,o.kt)("li",{parentName:"ul"},"Cloudformation"),(0,o.kt)("li",{parentName:"ul"},"CodeBuild"),(0,o.kt)("li",{parentName:"ul"},"CodePipeline"),(0,o.kt)("li",{parentName:"ul"},"Code Deploy"),(0,o.kt)("li",{parentName:"ul"},"CloudWatch"),(0,o.kt)("li",{parentName:"ul"},"CloudTrail"),(0,o.kt)("li",{parentName:"ul"},"SNS"),(0,o.kt)("li",{parentName:"ul"},"KMS"))),(0,o.kt)("li",{parentName:"ul"},"can be stored as plain text and ciphertext"),(0,o.kt)("li",{parentName:"ul"},"Lifecycle policies can be defined on parameter"),(0,o.kt)("li",{parentName:"ul"},"can be Encrypted using KMS")),(0,o.kt)("h4",{id:"sample-code-snippet-for-ssm-document-along-with-parameters"},"Sample code snippet for SSM document along with parameters"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"schemaVersion: '2.2'\ndescription: 'Run a script on Linux instances.'\nparameters:\n  commands:\n    type: String\n    description: \"(Required) The commands to run or the path to an existing script on the instance.\"\n    default: 'echo Hello World'\nmainSteps:\n- action: aws:runShellScript\n  name: runCommands\n  inputs:\n    timeoutSeconds: '60'\n    runCommand:\n    - \"{{ commands }}\"\n\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Code Ref: ",(0,o.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ssm-document.html"},"AWS::SSM::Document"))),(0,o.kt)("h2",{id:"session-manager"},"Session manager"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Manage EC2 instance or On-premises managed servers through an interactive browser based shell or through AWS CLI"),(0,o.kt)("li",{parentName:"ul"},"No need to enable SSH (port 22) on security groups"),(0,o.kt)("li",{parentName:"ul"},"No need of bastion host and SSH keys"),(0,o.kt)("li",{parentName:"ul"},"Can be controlled using the IAM policies"),(0,o.kt)("li",{parentName:"ul"},"logging and auditing can be done using ",(0,o.kt)("code",null,"CloudTrail"),"/",(0,o.kt)("code",null,"S3"),"/",(0,o.kt)("code",null,"CloudWatch"))),(0,o.kt)("h4",{id:"how-it-works"},"How it works"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"SSM Agent running in the instances are responsible for the interactive shell "),(0,o.kt)("li",{parentName:"ul"},"SSM Agent creates a ",(0,o.kt)("code",null,"user with sudo access")," and when the session is established, IAM user gets logged into the server as this SSM agent's ",(0,o.kt)("code",null,"user")),(0,o.kt)("li",{parentName:"ul"},"Communication between SSM and Instances secured with TLSv1.2 protocal and can be enhanced with KMS")),(0,o.kt)("h3",{id:"hybrid-activation"},"Hybrid Activation:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Install SSM agent on the server"),(0,o.kt)("li",{parentName:"ul"},"Create hybrid activation using the AWS SSM Console or AWSCLI and get the ",(0,o.kt)("code",null,"activation code")," & ",(0,o.kt)("code",null,"ID"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'aws ssm create-activation \\\n  --default-instance-name MyWebServers \\\n  --iam-role service-role/AmazonEC2RunCommandRoleForManagedInstances \\\n  --registration-limit 10 \\\n  --region us-east-2 \\\n  --tags "Key=Environment,Value=Production" "Key=Department,Value=Finance"\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Use the returned/generated ",(0,o.kt)("code",null,"activation code")," & ",(0,o.kt)("code",null,"ID")," in the server and register it with the AWS SSM")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'amazon-ssm-agent -register -code "activation-code" -id "activation-id" -region "region"\n')),(0,o.kt)("p",null,"For the complete steps, please visit aws documentation on ",(0,o.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-managedinstances.html"},"SSM for hybrid environments")),(0,o.kt)("h2",{id:"run-command"},"Run Command"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Remotely run commands/documents in all managed instances."),(0,o.kt)("li",{parentName:"ul"},"Instances can be selected by tag or resourse groups or managed instance id"),(0,o.kt)("li",{parentName:"ul"},"integrations",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"SNS for status notification"),(0,o.kt)("li",{parentName:"ul"},"S3 for execution output logs"),(0,o.kt)("li",{parentName:"ul"},"Cloudwatch for execution output logs"))),(0,o.kt)("li",{parentName:"ul"},"Useful in scripting automation")),(0,o.kt)("h2",{id:"state-manager"},"State manager"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Works via ",(0,o.kt)("code",null,"association")," and requires ",(0,o.kt)("code",null,"IAM Service Role")),(0,o.kt)("li",{parentName:"ul"},"Useful for keeping the ",(0,o.kt)("strong",{parentName:"li"},"managed instances in defined state"))),(0,o.kt)("h3",{id:"association"},"Association"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Configuration assigned to managed instances"),(0,o.kt)("li",{parentName:"ul"},"Runs on a schedule"),(0,o.kt)("li",{parentName:"ul"},"Need to specify",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Command Document"),(0,o.kt)("li",{parentName:"ul"},"Execution strategy"),(0,o.kt)("li",{parentName:"ul"},"input Parameters"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("code",null,"schedule")," or ",(0,o.kt)("code",null,"run once only")))),(0,o.kt)("li",{parentName:"ul"},"Output can be logged into S3 only.")),(0,o.kt)("h2",{id:"patch-manager"},"Patch Manager"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Can create your own ",(0,o.kt)("strong",{parentName:"li"},"patch baselines")," with the list of approved patches for installation on managed instances"),(0,o.kt)("li",{parentName:"ul"},"Can be used with ",(0,o.kt)("code",null,"maintenance Window")," for auto approved patch installation"),(0,o.kt)("li",{parentName:"ul"},"Uses SSM Documents for patch baselines and excution."),(0,o.kt)("li",{parentName:"ul"},"Patch Baselines defines which packages are approved for your instances. ")),(0,o.kt)("h2",{id:"inventory"},"Inventory"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Collects the ",(0,o.kt)("strong",{parentName:"li"},"metadata")," of the managed instances and optionally store it in ",(0,o.kt)("code",null,"S3"),"."),(0,o.kt)("li",{parentName:"ul"},"Keeps track of installed packages and versions"),(0,o.kt)("li",{parentName:"ul"},"Ref: ",(0,o.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-inventory.html"},"AWS SSM Inventory"))),(0,o.kt)("h2",{id:"distributor"},"Distributor"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"versatile software packaging and shipping tool for hybrid environments. "),(0,o.kt)("li",{parentName:"ul"},"Multi-platform package creation and shipping (Linux/Windows)"),(0,o.kt)("li",{parentName:"ul"},"Version control, and enables you to restrict access to creation and installation using IAM policies"),(0,o.kt)("li",{parentName:"ul"},"Can auto-generate software deployment commands and scripts on your behalf or give you the option to provide custom ones"),(0,o.kt)("li",{parentName:"ul"},"Software packages created in one account can be shared with other AWS accounts")),(0,o.kt)("h2",{id:"automation"},"Automation"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Complex IT workflows can be automated using SSM Automation."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("code",null,"Actions")," can define one or more series of steps and each step is associated with ",(0,o.kt)("code",null,"action")," or ",(0,o.kt)("code",null,"plugin")),(0,o.kt)("li",{parentName:"ul"},"AWS Services can be invokes using ",(0,o.kt)("code",null,"aws:executeAwsApi")," action; other actions allow waiting for the particular state before proceeding."),(0,o.kt)("li",{parentName:"ul"},"ref: ",(0,o.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/automation-actions.html"},"SSM Automation actions"))),(0,o.kt)("h2",{id:"references"},"References:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/how-it-works.html"},"How Systems Manager works")),(0,o.kt)("li",{parentName:"ul"},"SSM Agent logs: ",(0,o.kt)("code",null,"/var/log/amazon/ssm/amazon-ssm-agent.log"))))}d.isMDXComponent=!0}}]);